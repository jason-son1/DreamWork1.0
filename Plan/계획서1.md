# 마인크래프트 서버 개발 계획서: [야생 + 타운 + RPG]

## 1. 서버 개요 및 핵심 흐름 (Core Loop)

### 1.1 서버 컨셉

- **장르:** 야생(Survival) + 타운(Towny/Building) + 성장형 RPG
    
- **핵심 목표:** 유저는 야생에서 직업 활동(채광, 낚시 등)을 통해 성장하고 재화를 모아, 타운 월드에서 자신만의 건축물을 짓고 도시를 발전시킴.
    

### 1.2 유저 플레이 흐름 (Cycle)

1. **야생 월드 진입:** 자원 채집 및 직업 활동 (광부, 농부 등).
    
2. **RPG 성장:** 직업 레벨업 -> 스탯/스킬 개방 -> 파밍 효율 증가.
    
3. **보상 획득:** 퀘스트/미션 완료 및 상점 판매 -> '돈'과 '특수 재료' 획득.
    
4. **타운 월드 투자:** 획득한 돈으로 땅 구매(Claim), 특수 건축 자재 구매, 건축.
    
5. **장비 강화:** RPG 요소를 통한 도구/무기 강화 -> 더 깊은 야생/어려운 퀘스트 도전.
    

## 2. 기존 플러그인 활용 (인프라 구축)

바퀴를 다시 발명할 필요는 없습니다. 검증된 기존 플러그인으로 서버의 기초 뼈대를 잡습니다.

| 카테고리      | 추천 플러그인                     | 용도 및 설정 방향                                                   |
| --------- | --------------------------- | ------------------------------------------------------------ |
| **월드 관리** | **Multiverse-Core**         | 야생(주기적 초기화 가능), 타운(영구 보존), 자원 월드 분리 관리.                      |
| **권한 관리** | **LuckPerms**               | 유저 등급 및 관리자 권한 설정. 직업 레벨에 따른 칭호 부여 연동.                       |
| **경제**    | **Vault** + **EssentialsX** | 기초 경제 시스템 및 화폐(\\) 관리 표준 API.                                |
| **타운/보호** | **Towny Advanced**          | 건축 및 마을 시스템의 핵심. 땅 구매, 세금, 마을 간 연합 기능 제공. (또는 _Lands_ 사용 가능) |
| **채팅/UI** | **DecentHolograms**         | 마을 정보, 랭킹, NPC 머리 위 퀘스트 표시 등 시각적 요소.                         |
| **상점**    | **ShopGUI+**                | GUI 기반 상점. 야생 전리품 판매 및 건축 자재 구매 창구.                          |
| **NPC**   | **Citizens**                | 퀘스트 및 상점 NPC 생성.                                             |

## 3. 자체 개발 플러그인: `ProjectCore` (가칭) 설계를 위한 명세

이 플러그인은 특정 기능을 직접 구현하는 것이 아니라, **기획자가 config(설정 파일)만으로 새로운 직업, 스킬, 아이템 스탯을 찍어낼 수 있는 '엔진(Engine)'** 역할을 해야 합니다.

### 3.1 개발 철학: 데이터 주도 설계 (Data-Driven Design)

- **하드코딩 지양:** `if (job == miner)`와 같은 코드를 최소화합니다.
    
- **이벤트 리스너 통합:** 모든 행동(블럭 파괴, 낚시, 사냥)을 감지하는 통합 리스너를 만들고, 설정 파일에 정의된 조건(Trigger)과 결과(Result)를 매칭합니다.
    

### 3.2 핵심 모듈 상세 설계

#### Module A: 유동적 직업 & 숙련도 시스템 (Job & Mastery Engine)

사용자가 YAML 파일로 직업을 정의하면, 플러그인이 이를 로드하여 시스템화합니다.

- **기능 요구사항:**
    
    - 행동 트리거(Trigger) 정의: 특정 블럭 파괴, 특정 아이템 획득, 이동 거리 등.
        
    - 경험치 공식 커스텀: 레벨업 필요 경험치를 수식으로 설정.
        
    - 레벨업 보상(Reward): 스탯 부여, 명령어 실행, 메시지 출력.
        
- **설정 예시 (`jobs/miner.yml`):**
    
    ```
    job_id: "miner"
    display_name: "광부"
    max_level: 50
    exp_source:
      - type: BREAK_BLOCK
        target: DIAMOND_ORE
        amount: 10
      - type: BREAK_BLOCK
        target: STONE
        amount: 0.1
    rewards:
      - level: 10
        type: GIVE_STAT
        stat: "mining_speed"
        value: 0.5
      - level: 20
        type: COMMAND
        command: "lp user %player% parent add veteran_miner"
    ```
    

#### Module B: 커스텀 스탯 & RPG 속성 시스템 (Attribute Engine)

바닐라 마인크래프트의 NBT 태그를 활용하여 아이템에 새로운 속성을 부여하고 계산합니다.

- **기능 요구사항:**
    
    - **Stat Registry:** 새로운 스탯을 등록하는 시스템 (예: `mining_luck`, `double_drop_rate`, `critical_damage`).
        
    - **Lore/NBT 파싱:** 아이템의 Lore(설명)나 숨겨진 NBT 태그를 읽어 스탯을 적용.
        
    - **Attribute Modifier:** 바닐라 속성(공격력, 체력, 이속)을 안전하게 수정.
        
    - **PVE 확장성:** 추후 몬스터 데미지 계산식에 개입할 수 있는 구조 마련 (EntityDamageByEntityEvent 핸들링).
        
- **구현 로직:**
    
    1. 플레이어가 이벤트를 발생시킴 (블럭 파괴 등).
        
    2. `StatsManager`가 플레이어의 장비, 패시브 스킬(직업 보상)을 스캔하여 총합 스탯 계산.
        
    3. 계산된 스탯(예: `mining_luck` 20%)에 따라 추가 로직 실행 (광물 2개 드롭).
        

#### Module C: 퀘스트 & 미션 빌더 (Quest Builder)

복잡한 퀘스트 플러그인 대신, 직관적인 트리거 시스템을 사용합니다.

- **기능 요구사항:**
    
    - 직업 시스템과 연동되는 일일/주간/메인 퀘스트.
        
    - UI 제공 (Inventory GUI).
        
    - 진행도 추적 및 DB 저장 (MySQL/SQLite).
        
- **설정 예시 (`quests/daily_fishing.yml`):**
    
    ```
    quest_id: "daily_fish_1"
    name: "아침의 낚시꾼"
    type: DAILY
    requirements:
      - type: FISH_CATCH
        target: SALMON
        amount: 10
    rewards:
      - type: MONEY
        amount: 1000
      - type: JOB_EXP
        job: "fisher"
        amount: 500
    ```
    

## 4. 기술적 구현 가이드 (개발자를 위한 메모)

### 4.1 데이터 저장 (Persistence)

- **유저 데이터:** 직업 레벨, 현재 경험치, 퀘스트 진행 상황.
    
- **방식:**
    
    - 소규모: SQLite (파일 기반).
        
    - 대규모: MySQL/MariaDB (필수 권장).
        
- **비동기 처리:** I/O 작업(DB 저장/로드)은 반드시 메인 스레드가 아닌 비동기(Async) 스레드에서 처리하여 서버 렉 방지.
    

### 4.2 주요 API 및 클래스 구조 제안

- **`JobProvider` (Interface):** 모든 직업이 구현해야 하는 인터페이스.
    
- **`StatManager` (Class):** 플레이어의 스탯을 캐싱(Caching)하고 계산하는 싱글톤 클래스. 플레이어가 장비를 교체하거나 레벨업 할 때만 재계산(Recalculate) 수행.
    
- **`EffectProcessor` (Class):** 실제 게임 내 효과(더블 드롭, 폭발 채광 등)를 처리하는 로직.
    

### 4.3 타 플러그인 후킹 (Hooking)

- **Towny 연동:** Towny API를 사용하여 야생 월드에서는 땅 구매를 막고, 타운 월드에서만 가능하게 설정.
    
- **PlaceholderAPI 연동:** 채팅창이나 스코어보드에 `%core_job_level_miner%` 처럼 직업 정보를 표시할 수 있도록 확장 구현 필수.
    

## 5. 단계별 로드맵 (Roadmap)

### 1단계: 기반 마련 (1주차)

- 서버 코어(Paper/Purpur) 설치 및 최적화.
    
- 멀티버스, Towny, LuckPerms 등 기본 플러그인 설정.
    
- 월드 2개 생성 (Wild, Town) 및 포탈 연결.
    

### 2단계: 자체 플러그인 - 직업 엔진 개발 (2-3주차)

- `ProjectCore` 프로젝트 생성.
    
- YAML 설정 로더 구현.
    
- 이벤트 트리거 시스템 (블럭 파괴 -> 경험치 획득) 구현.
    
- 기초 직업 3종(광부, 농부, 어부) config 작성 및 테스트.
    

### 3단계: 자체 플러그인 - RPG 스탯 및 아이템 (4주차)

- 아이템 NBT 파싱 로직 구현.
    
- 스탯 효과 구현 (예: 광부의 '채굴 속도' 증가 - PotionEffect 활용 혹은 BlockBreakDelay 패킷 제어).
    
- 기존 바닐라 아이템에 Lore를 달아 테스트.
    

### 4단계: 경제 및 퀘스트 연결 (5주차)

- 퀘스트 시스템 구현 및 직업 경험치와 연동.
    
- 상점 아이템 가격 밸런싱.
    

### 5단계: 베타 테스트 및 밸런싱 (6주차~)

- 유저들을 야생에 풀어놓고 레벨업 속도 측정.
    
- 경제가 인플레이션 없이 타운 건축으로 이어지는지 확인.